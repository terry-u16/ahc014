# AHC014日記

## 1日目（土）

問題を読んだ。なにこれ。むずすぎ。

点を4つ選ぶ問題、どこかで見たことあるな。 → [JOI2007本戦C 最古の遺跡](https://atcoder.jp/contests/joi2007ho/tasks/joi2007ho_c)。ベクトルを使うと便利そう。

点ごとの得点分布ってどうなるんだろ。伝家の宝刀†Excel†を使おうと思ったが、複数回使う機会がありそうなのでPythonの方が良いか。

可視化した。思った以上に四隅のウェイトが大きい。中心付近はほぼ無価値。ちまちま伸ばすというよりは四隅を取りに行くゲームか？

ビジュアライザにmanual modeがあったので手でやってみる。むっず。合法手がどこかもぱっと見だと分からないな。端まで伸ばすとかそういうことを考える余裕がない。適当な貪欲を書いた方が早そう。

点を配置できる場所を考える。ある印の付いていない点p_0を起点に、u方向とv方向に伸ばして点p_1, p_2を見つける。そこからさらに伸ばして、他の点や線分にぶつからずにp_3が見つかればOK。N≦64だからビット演算で高速化できそうだが、斜めの処理がめんどくさそう。ビット演算はとりあえず後回しにして、今日はまず貪欲を完成させることを目標にしよう。

貪欲解を作った。長方形を構築可能な頂点の中から最も重みの大きいものを選ぶだけ。33.2Mで3位。これ外側目指すの難しすぎるな。縦横→斜め→縦横→斜め→……の順で伸ばしていくのだろうか……。

テストケースを捏造して遊んでみる。2本のラインを作って、そこから□と◇を無限に作れると強そう。

強化学習とかできたりする？いやむずそうだけど……。

盤面がデカいんだよなあ。計算量がConv2D 1回あたりΩ(N^2 K^2 C_in C_out)くらいかかるのでヤバそう。

ABCに参加。ギリギリGまで解けた。コンテスト中の橙diffは5回目なので嬉しい。

## 2日目（日）

案の定1位はもう50M点超えてる。長期コンの序盤の点数はアテにならない……。

[Magic Bitboard](https://ipsj.ixsq.nii.ac.jp/ej/index.php?active_action=repository_view_main_item_detail&page_id=13&block_id=8&item_id=71312&item_no=1)というものがあるらしい。メモっておく。まあとりあえずはRotated Bitboardで十分かな。多分書き込みより読み込みの方が多いし。

実装だるすぎてスーパーマリオサンシャインのRTAを観てしまい3時間を消費。攻略本片手に120枚集めた思い出。

どうにか実装。座標変換で頭がこわれそうになったけど思ったほどバグらなかった。サーバ上での実行時間は455ms→119msに短縮。満足……とまではいかないが、まあ4倍速くなったのは大きい。

クラウド実行環境の初期設定をした。 `dotnet tool install` でお手軽にできるようになったのでだいぶ良い。が、設定ファイルの書き方とか忘れてるな。どこかに書き残しておこう。
